# SELECT FOR NO KEY UPDATE

SELECT FOR NO KEY UPDATE는 MySQL에서 사용하는 SELECT 문 중 하나로, 행을 읽으면서 특정한 업데이트 잠금을 적용하는 역할을 합니다. 주로 트랜잭션 내에서 다른 트랜잭션들이 해당 행을 변경하지 못하도록 잠그는 용도로 사용됩니다.

작동 방식:

SELECT FOR NO KEY UPDATE는 지정한 행에 대해 읽기 잠금을 설정합니다. 하지만 키를 업데이트할 수 있는 잠금은 설정하지 않아서, 다른 트랜잭션들이 해당 행을 수정할 수는 없지만, 행의 키를 수정하려는 작업은 허용됩니다.

예시:

BEGIN;

SELECT * FROM my_table
WHERE id = 1
FOR NO KEY UPDATE;

-- 여기서 다른 트랜잭션이 id = 1인 행을 수정하는 것은 불가능하지만,
-- id = 1인 행의 PRIMARY KEY를 수정하는 것은 가능함.

COMMIT;

SELECT FOR NO KEY UPDATE와 관련된 주요 사항:
	•	키를 변경할 수 없음: 이 잠금은 행에 대한 키를 변경하는 작업을 막지 않지만, 그 외의 업데이트 작업은 막습니다.
	•	읽기 잠금: 데이터를 읽으면서 동시에 다른 트랜잭션이 해당 행을 수정하는 것을 방지합니다.
	•	트랜잭션의 일관성 유지: 트랜잭션 내에서 작업 중인 데이터를 다른 트랜잭션이 변경하지 못하게 하여 일관성을 유지할 수 있습니다.

주요 사용 예시:
	•	데이터 검증: 어떤 값이 특정 조건을 만족하는지 확인하고, 그 후 값을 변경하기 전에 데이터가 다른 트랜잭션에 의해 변경되지 않도록 잠그는 경우.
	•	복잡한 트랜잭션 처리: 여러 트랜잭션이 동시에 동일한 데이터를 처리하는 경우, NO KEY UPDATE를 통해 잠금을 설정하여 데이터 경합을 방지할 수 있습니다.

⸻

Q1: SELECT FOR NO KEY UPDATE를 사용하는 대신, 어떤 다른 잠금 방법을 사용할 수 있을까요?

Q2: SELECT FOR NO KEY UPDATE가 잘못 사용될 경우 발생할 수 있는 문제는 무엇일까요?

Q3: SELECT FOR NO KEY UPDATE와 SELECT FOR UPDATE의 차이점은 무엇인가요?